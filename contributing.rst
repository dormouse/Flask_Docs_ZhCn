å¦‚ä½•ä¸º Flask åšå‡ºè´¡çŒ®
==========================

æ„Ÿè°¢æ‚¨ä¸º Flask åšå‡ºè´¡çŒ®ï¼

é—®ç­”æ”¯æŒ
--------

è¯·ä¸è¦ä½¿ç”¨é—®é¢˜è·Ÿè¸ªå™¨æ¥æé—®ã€‚æœ‰å…³ä½ è‡ªå·±ä»£ç çš„é—®é¢˜è¯·ä½¿ç”¨ä¸‹åˆ—é€”å¾„ä¹‹ä¸€æé—®ï¼š

* åœ¨ FreeNode ä¸Šçš„ IRC ``#pocoo`` é¢‘é“ã€‚
* æ›´æ™®é€šçš„é—®é¢˜è¯·ä½¿ç”¨ FreeNode ä¸Šçš„ IRC ``#python`` é¢‘é“ã€‚
* Discord chat ä¸Šçš„ ``#get-help`` é¢‘é“ï¼š https://discordapp.com/invite/t6rrQZH
* FreeNode ä¸Šçš„ IRC ``#pocoo`` é¢‘é“ä¸ Discord å…³è”ï¼Œä½†æ˜¯è¯·ä¼˜å…ˆä½¿ç”¨ Discord ã€‚


* é‚®ä»¶åˆ—è¡¨ flask@python.org ç”¨äºé•¿æœŸæˆ–è€…å¤§å‹é—®é¢˜è®¨è®ºã€‚
* åœ¨ `Stack Overflow`_ ä¸Šæé—®ã€‚é¦–å…ˆä½¿ç”¨ä»¥ä¸‹æ–¹æ³•åœ¨ Google ä¸Šæœç´¢ï¼š
  ``site:stackoverflow.com flask {search term, exception message, etc.}``

.. _Stack Overflow: https://stackoverflow.com/questions/tagged/flask?sort=linked

æŠ¥å‘Šé—®é¢˜
----------------

- æè¿°ä½ å¸Œæœ›å‘ç”Ÿçš„äº‹æƒ…ã€‚
- å¦‚æœå¯èƒ½ï¼Œæä¾›ä¸€ä¸ª `æœ€å°çš„å¯é‡ç°çš„ç¤ºä¾‹`_ ä»¥å¸®åŠ©æˆ‘ä»¬æ‰¾åˆ°é—®é¢˜ã€‚
  è¿™ä¹Ÿæœ‰åŠ©äºé‰´åˆ«é—®é¢˜æ˜¯å¦ä¹Ÿä½ è‡ªå·±çš„ä»£ç æœ‰å…³ã€‚
- æè¿°å®é™…å‘ç”Ÿäº†ä»€ä¹ˆã€‚å¦‚æœæœ‰å¼‚å¸¸ï¼Œåˆ™åº”å½“åŒ…å«å®Œæ•´çš„å›æº¯ã€‚
- åˆ—å‡ºä½ çš„ Python ã€ Flask å’Œ Werkzeug ç‰ˆæœ¬ã€‚å¦‚æœå¯èƒ½ï¼Œæ£€æŸ¥æ˜¯å¦è¿™ä¸ªé—®é¢˜å·²
  åœ¨å­˜å‚¨åº“ä¸­ä¿®å¤ã€‚

.. _æœ€å°çš„å¯é‡ç°çš„ç¤ºä¾‹: https://stackoverflow.com/help/minimal-reproducible-example

æäº¤è¡¥ä¸
------------------

- ä½¿ç”¨ `Black`_ è‡ªåŠ¨æ ¼å¼åŒ–ä½ çš„ä»£ç ã€‚å½“ä½ è¿è¡Œ ``pip install -e .[dev]`` æ—¶ï¼Œ
  è¿™ä¸ªåŠŸèƒ½å°†è¢«é…ç½®ä¸ºä¸€ä¸ª git `pre-commit`_ é’©å­ã€‚
  ä½ å¯ä»¥è¿˜å¸Œæœ›ä½¿ç”¨ Black çš„ `ç¼–è¾‘å™¨é›†æˆ`_.
- å¦‚æœè¡¥ä¸æ˜¯ç”¨äºè§£å†³é”™è¯¯çš„ï¼Œé‚£ä¹ˆåº”å½“åŒ…å«ä¸€ä¸ªæµ‹è¯•ï¼Œå¹¶æ˜ç¡®è¯´æ˜é”™è¯¯å‘ç”Ÿäºä½•ç§
  æƒ…å†µä¹‹ä¸‹ã€‚ç¡®ä¿å¦‚æœæ²¡æœ‰è¡¥ä¸ï¼Œæµ‹è¯•å°±ä¼šå¤±è´¥ã€‚
- åœ¨ä½ çš„æäº¤ä¿¡æ¯ä¸­åŒ…å«ä¸€ä¸ªç±»ä¼¼ "Fixes #123" å­—ç¬¦ä¸²ï¼ˆå…¶ä¸­çš„ 123 æ˜¯æŒ‡ä½ ä¿®æ­£çš„
  issue ç¼–å·ï¼‰ã€‚
  å‚è§ `Closing issues using keywords
  <https://help.github.com/articles/creating-a-pull-request/>`__.

é¦–æ¬¡è®¾ç½®
~~~~~~~~~~~~~~~~

- ä¸‹è½½å¹¶å®‰è£… `æœ€æ–°ç‰ˆçš„ git`_.
- é…ç½®ä½¿ç”¨ git çš„ `username`_ å’Œ `email`_::

        git config --global user.name 'your name'
        git config --global user.email 'your email'

- ç¡®ä¿ä½ æœ‰ä¸€ä¸ª `GitHub è´¦å·`_.
- ç‚¹å‡» `Fork`_ æŒ‰é’®å°† Flask fork åˆ°ä½ çš„ GitHub è´¦æˆ·ã€‚
- æŠŠä½ çš„ GitHub fork `Clone`_ åˆ°æœ¬åœ°::

        git clone https://github.com/{username}/flask
        cd flask

- æ·»åŠ ä¸€ä¸ªä¸»å­˜å‚¨åº“ä½œä¸ºè¿œç¨‹åº“ï¼Œç¨åæ›´æ–°::

        git remote add pallets https://github.com/pallets/flask
        git fetch pallets

- åˆ›å»ºä¸€ä¸ª virtualenv::

        python3 -m venv env
        . env/bin/activate
        # or "env\Scripts\activate" on Windows

- åœ¨å¸¦æœ‰å¼€å‘ä¾èµ–çš„ç¼–è¾‘æ¨¡å¼ä¸‹å®‰è£… Flask::

        pip install -e ".[dev]"

- å®‰è£… `pre-commit framework`_.
- å®‰è£… pre-commit é’©å­::

        pre-commit install --install-hooks

.. _GitHub è´¦å·: https://github.com/join
.. _æœ€æ–°ç‰ˆçš„ git: https://git-scm.com/downloads
.. _username: https://help.github.com/en/articles/setting-your-username-in-git
.. _email: https://help.github.com/en/articles/setting-your-commit-email-address-in-git
.. _Fork: https://github.com/pallets/flask/fork
.. _Clone: https://help.github.com/en/articles/fork-a-repo#step-2-create-a-local-clone-of-your-fork
.. _pre-commit framework: https://pre-commit.com/#install

å¼€å§‹å†™ä»£ç 
~~~~~~~~~~~~

- åˆ›å»ºä¸€ä¸ªåˆ†æ”¯æ¥é‰´åˆ«ä½ æƒ³è¦å¤„ç†çš„é—®é¢˜ã€‚å¦‚æœè¦æäº¤ä¸€ä¸ªç¼ºé™·æˆ–è€…æ–‡æ¡£ä¿®æ­£ï¼Œè¯·ä»
  æœ€åçš„â€œ .x â€åˆ†æ”¯æ¥åˆ›å»ºåˆ†æ”¯::

      git checkout -b your-branch-name origin/1.0.x

  å¦‚æœè¦æäº¤ä¸€ä¸ªåŠŸèƒ½å¢åŠ æˆ–è€…æ›´æ”¹ï¼Œè¯·ä»â€œ master â€åˆ†æ”¯æ¥åˆ›å»ºåˆ†æ”¯::

      git checkout -b your-branch-name origin/master

- ä½¿ç”¨ä½ æœ€å–œæ¬¢çš„ç¼–è¾‘å™¨ï¼Œä¿®æ”¹ä»£ç ï¼Œ `éšæ—¶æäº¤`_ ã€‚
- åº”å½“åŒ…å«è¦†ç›–ä½ æ‰€åšçš„å…¨éƒ¨ä¿®æ”¹çš„æµ‹è¯•ã€‚ç¡®ä¿æ²¡æœ‰è¡¥ä¸åˆ™æµ‹è¯•å¤±è´¥ã€‚
  `è¿è¡Œæµ‹è¯• <contributing-testsuite_>`_ ã€‚
- å°†ä½ çš„æäº¤æ¨é€åˆ° GitHub å¹¶ `åˆ›å»ºä¸€ä¸ª pull request`_ ::

      git push --set-upstream origin your-branch-name

- åº†ç¥æˆåŠŸ ğŸ‰


.. _éšæ—¶æäº¤: https://dont-be-afraid-to-commit.readthedocs.io/en/latest/git/commandlinegit.html#commit-your-changes
.. _Black: https://black.readthedocs.io
.. _ç¼–è¾‘å™¨é›†æˆ: https://black.readthedocs.io/en/stable/editor_integration.html
.. _pre-commit: https://pre-commit.com
.. _åˆ›å»ºä¸€ä¸ª pull request: https://help.github.com/en/articles/creating-a-pull-request


.. _contributing-testsuite:

è¿è¡Œæµ‹è¯•
~~~~~~~~~~~~~~~~~

ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡ŒåŸºç¡€æµ‹è¯•::

    pytest

è¿™åªåœ¨å½“å‰ç¯å¢ƒä¸‹è¿è¡Œæµ‹è¯•ã€‚è¿™æ˜¯å¦ç›¸å…³å–å†³äºä½ åœ¨å¤„ç† Flask çš„å“ªä¸ªéƒ¨åˆ†ã€‚
å½“ä½ æäº¤ pull request æ—¶ï¼Œ Travis-CI ä¼šè¿è¡Œå…¨éƒ¨æµ‹è¯•ã€‚

å®Œæ•´çš„æµ‹è¯•å¥—ä»¶è¿è¡Œæ—¶é—´ä¼šå¾ˆé•¿ï¼Œå› ä¸ºå®ƒä¼šåœ¨å¤šç§ Python åŠå…¶ä¾èµ–çš„ç¯å¢ƒä¸‹è¿è¡Œã€‚
åœ¨æ‰€æœ‰ç¯å¢ƒä¸‹è¿è¡Œæµ‹è¯•éœ€è¦æœ‰ Python 2.7 ã€ 3.4 ã€ 3.5 ã€ 3.6 å’Œ PyPy 2.7 ã€‚
ç„¶åè¿è¡Œ::

    tox

è¿è¡Œæµ‹è¯•è¦†ç›–
~~~~~~~~~~~~~~~~~~~~~

ç”Ÿæˆä¸€ä¸ªå“ªäº›ä»£ç æœªè¢«æµ‹è¯•è¦†ç›–çš„æŠ¥å‘Šå¯ä»¥æŒ‡æ˜ä»å“ªé‡Œå¼€å§‹è´¡çŒ®ã€‚ä½¿ç”¨
``coverage`` è¿è¡Œ ``pytest`` å¹¶åœ¨ç»ˆç«¯ç”Ÿæˆä¸€ä¸ªæŠ¥å‘Šå’Œä¸€ä»½äº¤äº’ HTML æ–‡æ¡£::

    coverage run -m pytest
    coverage report
    coverage html
    # then open htmlcov/index.html

è¯·é˜…è¯»æ›´å¤šå…³äº `coverage <https://coverage.readthedocs.io>`_ çš„æ–‡æ¡£ã€‚

ç”¨ ``tox`` è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶ä¼šç»„åˆæ‰€æœ‰è¿è¡Œæµ‹è¯•çš„è¦†ç›–æŠ¥å‘Šã€‚


æ„å»ºæ–‡æ¡£
~~~~~~~~~~~~~~~~~

ä½¿ç”¨ Sphinx æ„å»º ``docs`` æ–‡ä»¶å¤¹ä¸­çš„æ–‡æ¡£::

    cd docs
    pip install -r requirements.txt
    make html

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ ``_build/html/index.html`` ä»¥æŸ¥çœ‹æ–‡æ¡£ã€‚

è¯·é˜…è¯»æ›´å¤šå…³äº `Sphinx <https://www.sphinx-doc.org/en/master/>`_ çš„å†…å®¹ã€‚


æ³¨æ„ï¼šé›¶å¡«å……æ–‡ä»¶æ¨¡å¼
-------------------------------

æœ¬å­˜å‚¨åº“åŒ…å«å¤šä¸ªé›¶å¡«å……æ–‡ä»¶æ¨¡å¼ï¼Œå½“æäº¤å­˜å‚¨åº“åˆ° GitHub ä¹‹å¤–çš„ git ä¸»æœºæ—¶å¯
èƒ½ä¼šå¼•å‘é—®é¢˜ã€‚ä¿®å¤è¿™ä¸ªé—®é¢˜ä¼šç ´åæäº¤å†å²è®°å½•ï¼Œå› æ­¤æˆ‘ä»¬å»ºè®®å¿½ç•¥è¿™ä¸ªé—®é¢˜ã€‚
å¦‚æœæ¨é€å¤±è´¥å¹¶ä¸”ä½ ä½¿ç”¨çš„æ˜¯å¦‚ GitLab è¿™æ ·çš„è‡ªæ‰˜ç®¡ git æœåŠ¡ï¼Œé‚£ä¹ˆåœ¨ç®¡ç†é¢æ¿
ä¸­å…³é—­å­˜å‚¨åº“æ£€æŸ¥ã€‚

è¿™äº›æ–‡ä»¶è¿˜ä¼šåœ¨å…‹éš†æ—¶å¼•å‘é—®é¢˜ã€‚å¦‚æœä½ åœ¨ git é…ç½®æ–‡ä»¶ä¸­æœ‰ä»¥ä¸‹è®¾ç½®::

    [fetch]
    fsckobjects = true

æˆ–è€… ::

    [receive]
    fsckObjects = true

é‚£ä¹ˆå…‹éš†æ—¶ä¼šå¤±è´¥ã€‚å”¯ä¸€çš„è§£å†³æ–¹æ³•æ˜¯åœ¨å…‹éš†æ—¶æŠŠä¸Šé¢çš„è®¾ç½®é¡¹ç›®è®¾ç½®ä¸º false ï¼Œ
å¹¶åœ¨å…‹éš†å®Œæˆåæ¢å¤ã€‚
